<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoSphere Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.8.2/docx.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <!-- Link to external CSS using url_for -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
</head>
<body class="light-mode">
    <!-- Mobile Menu Toggle -->
    <div class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <div class="logo-icon">
                <i class="fas fa-leaf"></i>
            </div>
            <span>EcoSphere</span>
        </div>
        <ul class="menu">
            <li class="active"><a href="#" data-page="dashboard-page"><i class="fas fa-home"></i> <span>Dashboard</span></a></li>
            <li><a href="#" data-page="analytics-page"><i class="fas fa-chart-line"></i> <span>Analytics</span></a></li>
            <li><a href="#" data-page="carbon-footprint-page"><i class="fas fa-cloud"></i> <span>Carbon Footprint</span></a></li>
            <li><a href="#" data-page="vitamin-d-page"><i class="fas fa-sun"></i> <span>Vitamin D</span></a></li>
            <li><a href="#" data-page="progress-page"><i class="fas fa-trophy"></i> <span>Progress</span></a></li>
            <li><a href="#" data-page="articles-page"><i class="fas fa-book"></i> <span>Articles</span></a></li>
            <li><a href="#" data-page="settings-page"><i class="fas fa-cog"></i> <span>Settings</span></a></li>
        </ul>
        <div class="dark-mode-toggle">
            <label class="toggle-switch">
                <input type="checkbox" id="darkModeToggle">
                <span class="slider round"></span>
            </label>
            <span>Dark Mode</span>
        </div>
    </div>

    <!-- Notification Popup (Moved outside main content to be global) -->
    <div class="notification-popup" id="notificationPopup">
        <div class="notification-header">
            <h3>Notifications</h3>
            <button class="notification-clear">Clear All</button>
        </div>
        <ul class="notification-list">
            <li class="notification-item unread">
                <div class="notification-title">
                    <i class="fas fa-leaf"></i> Eco Challenge Completed
                </div>
                <div class="notification-message">
                    You've completed the "Reduce Water Usage" challenge!
                </div>
                <div class="notification-time">
                    <i class="far fa-clock"></i> 2 hours ago
                </div>
            </li>
            <li class="notification-item">
                <div class="notification-title">
                    <i class="fas fa-chart-line"></i> Weekly Report
                </div>
                <div class="notification-message">
                    Your weekly carbon footprint report is ready to view.
                </div>
                <div class="notification-time">
                    <i class="far fa-clock"></i> 1 day ago
                </div>
            </li>
            <li class="notification-item">
                <div class="notification-title">
                    <i class="fas fa-trophy"></i> New Badge Earned
                </div>
                <div class="notification-message">
                    You've earned the "Energy Saver" badge for reducing electricity usage.
                </div>
                <div class="notification-time">
                    <i class="far fa-clock"></i> 3 days ago
                </div>
            </li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page-content">
            <!-- Navbar -->
            <div class="navbar">
                <div class="nav-title">
                    <h1>Dashboard Overview</h1>
                    <p>Last updated: Just now</p>
                </div>
                <div class="nav-actions">
                    <div class="notifications" id="notificationsBtn">
                        <i class="fas fa-bell"></i>
                        <span class="badge">3</span>
                    </div>
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <div class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                    </div>
                </div>
            </div>

            <!-- Main Dashboard Content -->
            <div class="dashboard-content">
                <!-- Left Column: Stats Cards -->
                <div class="stats-section">
                    <div class="stat-card temperature">
                        <div class="stat-icon temperature">
                            <i class="fas fa-thermometer-half"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Temperature</h3>
                            <p>24.5¬∞C <span class="trend up"><i class="fas fa-arrow-up"></i> 0.3¬∞C</span></p>
                        </div>
                    </div>

                    <div class="stat-card humidity">
                        <div class="stat-icon humidity">
                            <i class="fas fa-tint"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Humidity</h3>
                            <p>68% <span class="trend down"><i class="fas fa-arrow-down"></i> 2%</span></p>
                        </div>
                    </div>

                    <div class="stat-card light">
                        <div class="stat-icon light">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Light</h3>
                            <p>Optimal <span class="trend up"><i class="fas fa-check"></i> Stable</span></p>
                        </div>
                    </div>

                    <div class="stat-card ph">
                        <div class="stat-icon ph">
                            <i class="fas fa-flask"></i>
                        </div>
                        <div class="stat-info">
                            <h3>pH Level</h3>
                            <p>7.2 <span class="trend up"><i class="fas fa-check"></i> Balanced</span></p>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Profile Section -->
<div class="profile-section">
  <aside>
        <div class="card profile-box">
          <div class="avatar-wrapper">
            <div class="avatar" id="avatar" title="Click to edit profile"></div>
            <div class="achievement-badge" id="profileBadge" style="display:none"></div>
          </div>
          <div class="profile-name" id="profileName">Jane Doe</div>
          <div class="profile-email" id="profileEmail">jane@example.com</div>

          <div class="profile-actions">
            <button class="btn" onclick="openEditProfile()">Edit profile</button>
            <button class="btn ghost" onclick="openBadgeSelector()">Display Badge</button>
          </div>

          <div style="margin-top:16px;width:100%">
            <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:4px">
              <span class="small-muted">Level <span id="userLevel">‚Äî</span></span>
              <span><strong id="userPoints">0</strong> Progress</span>
            </div>
            <div class="points-progress">
              <div class="points-fill" id="pointsFill"></div>
            </div>
          </div>
        </div>
      </aside>

                    <div class="contribution-card">
                        <h4>Journey Flow</h4>
                        <div class="contribution-grid">
                            <div title="Planted Trees"></div>
                            <div title="Reduced Emissions"></div>
                            <div title="Saved Energy"></div>
                            <div title="Clean-Up Drive"></div>
                            <div title="Eco Challenge"></div>
                            <div></div><div></div><div></div><div></div><div></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analytics Page -->
        <div id="analytics-page" class="page-content">
            <div class="page-header">
                <h1>Analytics</h1>
                <div class="actions">
                    <div class="export-container">
    <button class="btn-export" id="exportDataBtn">
        <i class="fas fa-file-export"></i> Export Data
    </button>
    <div class="export-dropdown">
        <a href="#" data-type="csv"><i class="fas fa-file-csv"></i> CSV</a>
        <a href="#" data-type="pdf"><i class="fas fa-file-pdf"></i> PDF</a>
        <a href="#" data-type="docx"><i class="fas fa-file-word"></i> DOCX</a>
        <a href="#" data-type="json"><i class="fas fa-file-code"></i> JSON</a>
        <a href="#" data-type="png"><i class="fas fa-file-image"></i> PNG</a>
        <a href="#" data-type="jpeg"><i class="fas fa-file-image"></i> JPEG</a>
    </div>
</div>
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <div class="notifications" id="notificationsBtn">
                        <i class="fas fa-bell"></i>
                        <span class="badge">3</span>
                    </div>
                    <div class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                    </div>
                </div>
            </div>

            <div class="metrics">
                <div class="metric-card">
                    <h3>Avg. Temperature</h3>
                    <div class="value">24.2¬∞C</div>
                    <div class="change positive">+0.5¬∞C <i class="fas fa-arrow-up"></i></div>
                </div>
                <div class="metric-card">
                    <h3>Avg. Humidity</h3>
                    <div class="value">67%</div>
                    <div class="change negative">-2% <i class="fas fa-arrow-down"></i></div>
                </div>
                <div class="metric-card">
                    <h3>Light Hours</h3>
                    <div class="value">14h</div>
                    <div class="change positive">+1h <i class="fas fa-arrow-up"></i></div>
                </div>
                <div class="metric-card">
                    <h3>Water Changes</h3>
                    <div class="value">3</div>
                    <div class="change positive">+1 <i class="fas fa-arrow-up"></i></div>
                </div>
            </div>

            <!-- Added Charts Container -->
            <div class="charts-container">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>Temperature Trends</h3>
                        <div class="chart-actions">
                            <button class="timeframe-btn active" data-timeframe="day">Day</button>
                            <button class="timeframe-btn" data-timeframe="week">Week</button>
                            <button class="timeframe-btn" data-timeframe="month">Month</button>
                        </div>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="temperatureChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3>pH Level History</h3>
                        <div class="chart-actions">
                            <button class="timeframe-btn active" data-timeframe="day">Day</button>
                            <button class="timeframe-btn" data-timeframe="week">Week</button>
                            <button class="timeframe-btn" data-timeframe="month">Month</button>
                        </div>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="phChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Environmental Trends</h2>
                <div class="chart-wrapper">
                    <canvas id="analyticsChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Carbon Footprint Page -->
        <div id="carbon-footprint-page" class="page-content">
            <div class="page-header">
                <h1>Carbon Footprint Tracker</h1>
                <div class="actions">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <div class="notifications" id="notificationsBtn">
                        <i class="fas fa-bell"></i>
                        <span class="badge">3</span>
                    </div>
                    <div class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                    </div>
                </div>
            </div>
            <div class="stats-grid">
                <div class="stat-card transport">
                    <div class="stat-icon transport">
                        <i class="fas fa-car"></i>
                    </div>
                    <div class="stat-info">
                        <h3>Transport</h3>
                        <p id="transport-co2">0 kg</p>
                        <span class="trend up"><i class="fas fa-arrow-up"></i> Daily</span>
                    </div>
                </div>
                <div class="stat-card food">
                    <div class="stat-icon food">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <div class="stat-info">
                        <h3>Food</h3>
                        <p id="food-co2">0 kg</p>
                        <span class="trend down"><i class="fas fa-arrow-down"></i> Weekly</span>
                    </div>
                </div>
                <div class="stat-card energy">
                    <div class="stat-icon energy">
                        <i class="fas fa-bolt"></i>
                    </div>
                    <div class="stat-info">
                        <h3>Energy</h3>
                        <p id="energy-co2">0 kWh</p>
                        <span class="trend up"><i class="fas fa-chart-line"></i> Monthly</span>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Daily Carbon Log</h2>
                <div class="log-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-tags"></i> Category</label>
                            <select id="category-select" class="form-control">
                                <option value="transport">üöó Transport</option>
                                <option value="food">üçî Food</option>
                                <option value="energy">‚ö° Energy</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row" id="dynamic-inputs">
                        <!-- Dynamic inputs will appear here -->
                    </div>
                    
                    <button type="button" class="btn-log-entry" id="log-entry">
                        <i class="fas fa-calculator"></i> Calculate CO‚ÇÇ Footprint
                    </button>
                </div>
            </div>
           <!-- Pop-up overlays (one per calculator) -->
<div id="popup-transport" class="popup-overlay">
    <div class="popup-modal">
        <span class="popup-close" onclick="closePopup('popup-transport')">&times;</span>
        <iframe class="popup-iframe" src="/api/carbon/transport"></iframe>
    </div>
</div>

<div id="popup-food" class="popup-overlay">
    <div class="popup-modal">
        <span class="popup-close" onclick="closePopup('popup-food')">&times;</span>
        <iframe class="popup-iframe" src="/api/carbon/food"></iframe>
    </div>
</div>

<div id="popup-energy" class="popup-overlay">
    <div class="popup-modal">
        <span class="popup-close" onclick="closePopup('popup-energy')">&times;</span>
        <iframe class="popup-iframe" src="/api/carbon/energy"></iframe>
    </div>
</div>
            <div class="card">
                <h2>Real-time CO‚ÇÇ Impact</h2>
                <div class="chart-wrapper">
                    <canvas id="co2Chart"></canvas>
                </div>
            </div>
        </div>

        <!-- Vitamin D Estimator Page -->
        <div id="vitamin-d-page" class="page-content">
            <div class="page-header">
                <h1>Vitamin D Estimator</h1>
                <div class="actions">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <div class="notifications" id="notificationsBtn">
                        <i class="fas fa-bell"></i>
                        <span class="badge">3</span>
                    </div>
                    <div class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                    </div>
                </div>
            </div>

            <div class="vitamin-controls">
                <!-- Location and Personalization Grid -->
                <div class="location-personalization">
                    <!-- Location Section -->
                    <div class="card">
                        <h2>Location Detection</h2>
                        <div class="detection-options">
                            <button id="auto-detect" class="detection-btn active">
                                <i class="fas fa-location-arrow"></i> Auto Detect
                            </button>
                            <button id="manual-input" class="detection-btn">
                                <i class="fas fa-map-marker-alt"></i> Manual Input
                            </button>
                        </div>

                        <div class="location-inputs">
                            <!-- Auto-detect will show this -->
                            <div id="auto-section" class="input-section">
                                <p>We'll use your device's location to get accurate UV data</p>
                                <button id="get-location" class="btn-primary">
                                    <i class="fas fa-crosshairs"></i> Detect My Location
                                </button>
                            </div>

                            <!-- Manual input will show this -->
                            <div id="manual-section" class="input-section" style="display:none">
                                <div class="form-row">
                                    <div class="form-group country-select">
                                        <label><i class="fas fa-globe"></i> Country</label>
                                        <select id="country-select" class="form-control">
                                            <option value="">Select Country</option>
                                            <!-- Options will be populated by JS -->
                                        </select>
                                    </div>
                                    <div class="form-group city-select">
                                        <label><i class="fas fa-city"></i> City</label>
                                        <select id="city-select" class="form-control" disabled>
                                            <option value="">Select City</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Personalization Section -->
                    <div class="card">
                        <h2>Personalization</h2>
                        <div class="form-row">
                            <div class="form-group">
                                <label><i class="fas fa-user"></i> Skin Type</label>
                                <select id="skin-type" class="form-control">
                                    <option value="1">Type I (Very Fair)</option>
                                    <option value="2">Type II (Fair)</option>
                                    <option value="3">Type III (Medium)</option>
                                    <option value="4">Type IV (Olive)</option>
                                    <option value="5">Type V (Brown)</option>
                                    <option value="6">Type VI (Dark)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-clock"></i> Exposure (minutes)</label>
                                <input type="number" id="exposure-time" class="form-control" min="1" max="240" value="15">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Results Section -->
                <div class="card results-card">
                    <h2>Your Vitamin D Analysis</h2>
                    <div class="vitamin-stats">
                        <div class="stat-card uv-index">
                            <div class="stat-icon uv-index" style="background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);">
                                <i class="fas fa-sun"></i>
                            </div>
                            <div class="stat-info">
                                <h3>Current UV Index</h3>
                                <p id="current-uv">--</p>
                            </div>
                        </div>
                        <div class="stat-card exposure">
                            <div class="stat-icon exposure" style="background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="stat-info">
                                <h3>Recommended Exposure</h3>
                                <p id="recommended-time">-- min</p>
                            </div>
                        </div>
                        <div class="stat-card level">
                            <div class="stat-icon level" style="background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-info">
                                <h3>Your Level</h3>
                                <p id="vitamin-level">--</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chart-wrapper">
                        <canvas id="vitaminChart"></canvas>
                    </div>

                    <div class="vitamin-card">
                        <h3>Vitamin D Estimator</h3>
                        <p id="uv-index">UV Index: --</p>
                        <p id="vitamin-advice">Advice: --</p>
                    </div>
                </div>
            </div>
        </div>

       <!-- Updated Progress & Badges Page (Final Version) -->
<div id="progress-page" class="page-content">
    <div class="page-header">
        <h1>Progress & Badges</h1>
        <div class="actions">
            <div class="share-container">
                <button class="share-btn">
                    <i class="fas fa-share-alt"></i> Share Progress
                </button>
                <div class="share-dropdown">
                    <a href="#"><i class="fab fa-facebook-f"></i> Facebook</a>
                    <a href="#"><i class="fab fa-twitter"></i> Twitter</a>
                    <a href="#"><i class="fab fa-linkedin-in"></i> LinkedIn</a>
                    <a href="#"><i class="fas fa-envelope"></i> Email</a>
                </div>
            </div>
            <div class="search-bar">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="Search...">
            </div>
            <div class="notifications" id="notificationsBtn">
                <i class="fas fa-bell"></i>
                <span class="badge">3</span>
            </div>
            <div class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
            </div>
        </div>
    </div>

    <main class="progress-page">
        <div class="section card">
          <h2>Your Achievement</h2>
          <p class="small-muted" style="margin-top:6px">Collect up to 12 badges. Unlocking a badge will allow you to display it on your profile.</p>
          <div style="height:12px"></div>
          <div class="badges-container" id="badgesContainer"></div>
        </div>

        <div class="section card">
          <h2>Your Progress</h2>
          <div class="progress-grid" style="margin-top:10px">
            <div>
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                <div><strong>Current Rank</strong></div>
                <div class="small-muted" id="rankPercentText">0%</div>
              </div>
              <div class="progress-bar"><div class="progress-fill" id="rankFill"></div></div>
              <div style="margin-top:8px" id="rankDetails" class="small-muted">Level ‚Äî</div>
            </div>

            <div>
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                <div><strong>Eco Habits</strong></div>
                <div><a href="#" onclick="openHabits()" class="small-muted">Manage</a></div>
              </div>
              <div class="habit-list" id="habitList"></div>
            </div>
          </div>
        </div>

        <div class="section card">
          <h2>Progress Log (Recent)</h2>
          <div id="activityLog" class="small-muted" style="margin-top:8px;max-height:160px;overflow:auto"></div>
        </div>
      </main>
    </div>

  <div id="modalRoot"></div>
  <div id="toastRoot"></div>


        <!-- Articles & Notes Page -->
        <div id="articles-page" class="page-content">
            <div class="page-header">
                <h1>Articles & Notes</h1>
                <div class="actions">
                    <button class="btn-new-note" id="newNoteBtn">
                        <i class="fas fa-plus"></i> New Note
                    </button>
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <div class="notifications" id="notificationsBtn">
                        <i class="fas fa-bell"></i>
                        <span class="badge">3</span>
                    </div>
                    <div class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2>Featured Articles</h2>
                <div class="articles-grid">
                    <div class="article-card">
                        <div class="article-image" style="background-image: url('https://images.unsplash.com/photo-1466611653911-95081537e5b7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60');"></div>
                        <div class="article-content">
                            <h3 class="article-title">10 Ways to Reduce Your Carbon Footprint</h3>
                            <p class="article-excerpt">Simple changes you can make today to significantly reduce your environmental impact and live more sustainably.</p>
                            <div class="article-meta">
                                <span><i class="far fa-clock"></i> 5 min read</span>
                                <span><i class="far fa-calendar-alt"></i> May 15, 2023</span>
                            </div>
                        </div>
                    </div>
                    <div class="article-card">
                        <div class="article-image" style="background-image: url('https://images.unsplash.com/photo-1508514177221-188b1cf16e9d?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60');"></div>
                        <div class="article-content">
                            <h3 class="article-title">The Science of Hydroponics</h3>
                            <p class="article-excerpt">How soil-less gardening can revolutionize food production and reduce water usage by up to 90% compared to traditional farming.</p>
                            <div class="article-meta">
                                <span><i class="far fa-clock"></i> 8 min read</span>
                                <span><i class="far fa-calendar-alt"></i> April 28, 2023</span>
                            </div>
                        </div>
                    </div>
                    <div class="article-card">
                        <div class="article-image" style="background-image: url('https://images.unsplash.com/photo-1488197047962-b48492212cda?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60');"></div>
                        <div class="article-content">
                            <h3 class="article-title">Understanding Your Vitamin D Needs</h3>
                            <p class="article-excerpt">Learn how much sunlight you really need for optimal vitamin D production based on your skin type and location.</p>
                            <div class="article-meta">
                                <span><i class="far fa-clock"></i> 6 min read</span>
                                <span><i class="far fa-calendar-alt"></i> April 10, 2023</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="notes-header">
                    <h2>Your Notes</h2>
                    <button class="add-note" id="addNoteBtn">
                        <i class="fas fa-plus"></i> Add Note
                    </button>
                </div>
                <div class="note">
                    <h3 class="note-title">Water Quality Observations</h3>
                    <p class="note-content">pH levels have been stable at 7.2 for the past week. Need to check ammonia levels tomorrow morning.</p>
                </div>
                <div class="note">
                    <h3 class="note-title">Light Schedule Changes</h3>
                    <p class="note-content">Increased grow light duration by 30 minutes to promote faster plant growth.</p>
                </div>
                <div class="note">
                    <h3 class="note-title">Carbon Offset Ideas</h3>
                    <p class="note-content">Research local tree planting initiatives to offset estimated 4.2 tons of annual CO‚ÇÇ emissions.</p>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-page" class="page-content">
            <div class="page-header">
                <h1>Settings</h1>
                <div class="actions">
                    <div class="search-bar">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <div class="notifications" id="notificationsBtn">
                        <i class="fas fa-bell"></i>
                        <span class="badge">3</span>
                    </div>
                    <div class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i>
                    </div>
                </div>
            </div>

            <div class="settings-section">
                <h2>System Settings</h2>
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>Automatic Updates</h3>
                        <p>Keep system up to date</p>
                    </div>
                    <label class="settings-toggle">
                        <input type="checkbox" checked>
                        <span class="settings-slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>Data Backup</h3>
                        <p>Daily backup to cloud</p>
                    </div>
                    <label class="settings-toggle">
                        <input type="checkbox" checked>
                        <span class="settings-slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>Maintenance Mode</h3>
                        <p>Temporarily disable system</p>
                    </div>
                    <label class="settings-toggle">
                        <input type="checkbox">
                        <span class="settings-slider"></span>
                    </label>
                </div>
            </div>

            <div class="settings-section">
                <h2>Notification Settings</h2>
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>Email Alerts</h3>
                        <p>Receive email notifications</p>
                    </div>
                    <label class="settings-toggle">
                        <input type="checkbox" checked>
                        <span class="settings-slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>Push Notifications</h3>
                        <p>Mobile app alerts</p>
                    </div>
                    <label class="settings-toggle">
                        <input type="checkbox" checked>
                        <span class="settings-slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-info">
                        <h3>SMS Alerts</h3>
                        <p>Critical alerts via SMS</p>
                    </div>
                    <label class="settings-toggle">
                        <input type="checkbox">
                        <span class="settings-slider"></span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- EcoBot AI Assistant -->
    <div class="ai-assistant">
        <!-- Floating Button -->
        <button class="ai-btn glass-card" id="aiAssistantBtn">
            <i class="fas fa-leaf"></i>
            <span class="pulse-dot"></span>
        </button>

        <!-- Chat Container -->
        <div class="ai-container glass-card" id="aiAssistantContainer">
            <!-- Header -->
            <div class="ai-header">
                <div class="ai-header-bg"></div>
                <div class="ai-title">
                    <div class="ai-avatar">
                        <i class="fas fa-leaf"></i>
                    </div>
                    <div>
                        <h3>EcoBot Assistant</h3>
                        <div class="ai-status">
                            <span class="status-dot"></span>
                            <span>Online</span>
                        </div>
                    </div>
                </div>
                <div class="ai-controls">
                    <button class="ai-control-btn" id="newChatBtn" title="New Chat">
                        <i class="fas fa-plus"></i>
                    </button>
                    <button class="ai-control-btn" id="historyBtn" title="Chat History">
                        <i class="fas fa-history"></i>
                    </button>
                    <button class="ai-close" id="aiAssistantClose" title="Close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>

            <!-- Chat History Sidebar -->
            <div class="ai-history-panel" id="historyPanel">
                <div class="history-header">
                    <h4><i class="fas fa-history"></i> Chat History</h4>
                    <button class="close-history" id="closeHistoryBtn" title="Close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="history-list" id="historyList">
                    <!-- History items will be added here dynamically -->
                </div>
            </div>

            <!-- Message Container -->
            <div class="ai-messages" id="aiMessages">
                <!-- Messages will appear here -->
                <div class="typing-indicator" id="typingIndicator">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="ai-input">
                <div class="quick-actions">
                    <button class="quick-btn eco-tip" data-action="footprint">
                        <i class="fas fa-shoe-prints"></i> Footprint Tips
                    </button>
                    <button class="quick-btn eco-tip" data-action="vitaminD">
                        <i class="fas fa-sun"></i> Sunlight Advice
                    </button>
                    <button class="quick-btn eco-tip" data-action="recycling">
                        <i class="fas fa-recycle"></i> Recycling Guide
                    </button>
                </div>
                <div class="input-wrapper">
                    <input type="text" id="aiInput" placeholder="Ask about sustainability..." autocomplete="off">
                    <button id="aiSend" title="Send"><i class="fas fa-paper-plane"></i></button>
                    <button id="aiVoice" class="voice-btn" title="Voice Input"><i class="fas fa-microphone"></i></button>
                </div>
                <div class="disclaimer">
                    <i class="fas fa-info-circle"></i> EcoBot may produce inaccurate information about sustainability.
                </div>
            </div>
        </div>
    </div>

    <!-- Note Modal -->
    <div id="noteModal" class="note-modal">
        <div class="note-modal-content">
            <div class="note-modal-header">
                <h2>Create New Note</h2>
                <span class="note-modal-close">&times;</span>
            </div>
            <form class="note-form">
                <input type="text" placeholder="Note Title" required>
                <textarea placeholder="Write your note here..." required></textarea>
                
                <div class="attachment-options">
                    <div class="attachment-btn" title="Add Image">
                        <i class="fas fa-image"></i>
                    </div>
                    <div class="attachment-btn" title="Add File">
                        <i class="fas fa-paperclip"></i>
                    </div>
                    <div class="attachment-btn" title="Add Location">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                </div>
                
                <button type="submit">Save Note</button>
            </form>
        </div>
    </div>
    <!-- Link to external JS using url_for -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>